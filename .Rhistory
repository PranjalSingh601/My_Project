library(readxl)
housing<-read_excel("Final_project.xls")
attach(housing)
a<-lm(sell~.,data=housing)
std_resid<-(resid(a)-mean(resid(a)))/sd(resid(a))
hist(std_resid,freq = FALSE)
curve(dnorm,add=TRUE)
hist(std_resid,freq = FALSE,col = "blue")
curve(dnorm,add=TRUE,lty=10,col="red")
library("dplyr")
trf_housing<-housing %>% mutate(log_sell=log(sell))
head(trf_housing)
str(trf_housing)
b<-lm(log_sell~lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=trf_housing)
summary(b)
plot(b)
std_resid_b<-(resid(b)-mean(resid(b)))/sd(resid(b))
plot(std_resid_b,freq=FALSE)
hist(std_resid_b,freq=FALSE,col="blue")
curve(dnorm,add=TRUE,col="red",lwd=2)
summary(b)
trf_housing<-trf_housing %>% mutate(log_lot=log(lot))
str(trf_housing)
c<-lm(log_sell~lot+log_lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=trf_housing)
summary(c)
trf_housing
names(trf_housing)
new_model<-lm(log_sell~log_lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=trf_housing)
trf_housing_new<- trf_housing %>% mutate(log_lot_c=log_lot-mean(log_lot),bdms_int=(bdms-mean(bdms))*log_lot_c,fb_int=(fb-mean(fb))*log_lot_c,sty_int=(sty-mean(sty))*log_lot_c,drv_int=(drv-mean(drv))*log_lot_c,rec_int=(rec-mean(rec))*log_lot_c,ffin_int=(ffin-mean(ffin))*log_lot_c,ghw_int=(ghw-mean(ghw))*log_lot_c,ca_int=(ca-mean(fb))*log_lot_c,gar_int=(gar-mean(gar))*log_lot_c,reg_int=(reg-mean(reg))*log_lot_c)
str(trf_housing_new)
interaction_model<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int+reg_int,data=trf_housing_new)
summary(trf_housing_new)
summary(interaction_model)
summary(trf_housing_new)
summary(new_model)
nrow(housing)
((.69)^2-(.68)^2)/(1-(.69)^2)
524/10*.02615003
qf(.95,10,524)
qf(.95,4,5)
summary(interaction_model)
interaction_model_1<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_1)
interaction_model_2<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
summaryIinteraction_model_2)
interaction_model_3<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_3)
interaction_model_4<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_4)
interaction_model_5<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+gar_int,data=trf_housing_new)
summary(interaction_model_5)
interaction_model_6<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int,data=trf_housing_new)
summary(interaction_model_6)
interaction_model_7<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+sty_int+drv_int+rec_int,data=trf_housing_new)
summary(interaction_model_7)
interaction_model_8<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+drv_int+rec_int,data=trf_housing_new)
summary(interaction_model_8)

install.packages("stargazer")
library("stargazer")

stargazer(interaction_model, type = "text", out = "interaction_model.txt")
stargazer(interaction_model_1, type = "excel", out = "interaction_model_1.xls")
stargazer(interaction_model_2, type = "text", out = "interaction_model_2.txt")
stargazer(interaction_model_3, type = "text", out = "interaction_model_3.txt")
stargazer(interaction_model_4, type = "text", out = "interaction_model_4.txt")
stargazer(interaction_model_5, type = "text", out = "interaction_model_5.txt")
stargazer(interaction_model_6, type = "text", out = "interaction_model_6.txt")
stargazer(interaction_model_7, type = "text", out = "interaction_model_7.txt")
stargazer(interaction_model_8, type = "text", out = "interaction_model_8.txt")
stargazer(interaction_model_9, type = "text", out = "interaction_model_9.txt")

trf_housing_new
trf_housing
names(trf_housing)
trf_housing$obs<-NULL
names(trf_housing)
train<-trf_housing[1:nrow(trf_housing),]
nrow(trf_housing)
train<-trf_housing[1:400,]
nrow(train)
test<-trf_housing[401:nrow(trf_housing),]
nrow(test)
names(train)
attach(train)

train_lm<-lm(log_sell~log_lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=train)
summary(train_lm)
prediction<-predict(train_lm,test,metric=rmse)
summary(prediction)

MAE<-mean(abs(prediction-test$log_sell))
MAE
sd(trf_housing$log_sell)
(sd(trf_housing$log_sell))^2
