libray(read_xl)
library(readxl)
Housing<-read_excel("Final_project.xls")
dir()
dir()
Housing<-read_excel("Final_project.xls")
head(Housing)
str(Housing)
attach(Housing)
housing$obs<as.integer(Housing$obs)
Housing$obs<as.integer(Housing$obs)
Housing$obs<-as.integer(Housing$obs)
class(obs)
str(Housing)
class(housing$obs)
class(Housing$obs)
class(obs)
ncol(Housing)
colnames(Housing)<-1:ncol(Housing)
head(Housing)
Housing$obs<-as.integer(Housing$obs)
Housing<-read_excel("Final_project.xls")
Housing$obs<-as.integer(Housing$obs)
colnames(Housing)
sapply(Housing[,"drv":"reg",-"gar"],as.factor)
sapply(Housing[,"drv":"reg"],as.factor)
head(Housing)
sum(is.na(Housing))
sapply(Housing[,5:13],as.factor)
class(Housing$drv)
str(Housing)
Housing<-read_excel("Final_project.xls")
str(Housing)
Housing$obs<-as.integer(Housing$obs)
class(Housing$obs)
Housing1<-sapply(Housing[,c(7:13,-6)],as.factor)
Housing1<-sapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing1)
head(Housing1)
class(Housing1$drv)
Housing1<-lapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing1)
lapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing)
sapply(Housing[,c(7,8,9,10,11,13)],as.factor)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing)
class(Housing$drv)
levels(Housing$drv)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],function(x){as.factor()})
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],function(x){as.factor})
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],function(x){as.factor})
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],function(x){as.factor(x)})
str(Housing)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],as.factor)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],function(x){as.factor()})
str(Housing)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],as.character)
str(Housing)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],as.numeric)
str(Housing)
unique(Housing$reg)
Housing[,c(7,8,9,10,11,13)]<-sapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing)
Housing[,c(7,8,9,10,11,13)]<-lapply(Housing[,c(7,8,9,10,11,13)],as.factor)
str(Housing)
head(Housing)
class(Housing$drv)
levels(Housing$drv)
attach(Housing)
a<-lm(sell~.,data=Housing)
summary(a)
abline(a)
abline(a)
abline(a)
abline(a)
abline(a)
abline(a)
abline(a)
?abline
abline(lm(sell~lot,data=Housing)
a'<-(lm(sell~lot,data=Housing)
)
a'<-lm(sell~lot,data=Housing)
a_dash<-lm(sell~lot,data=Housing)
abline(a_dash)
abline(a_dash,lty=2)
abline(lm(sell~lot,data=Housing))
head(iris)
abline(lm(sepal.length~sepal.width,data=iris))
abline(lm(sepal.Length~sepal.width,data=iris))
abline(lm(Sepal.Length~Sepal.Width,data=iris))
carModel <- lm(mpg~ wt, data = mtcars)
abline(CarModel)
carModel <- lm(mpg~ wt, data = mtcars)
abline(carModel)
abline(carModel)
abline(carModel)
hist(Sepla.Length)
hist(Sepal.Length)
hist(Sepal.Length,data=iris)
hist(Sepal.Length,data=iris)
library(readxl)
housing<-read_excel("Final_project.xls")
names(housing)
attach(housing)
a<-lm(sell~.,data=housing)
plot(housing$sell,fitted(a))
plot(fitted(a))
abline(plot(fitted(a)))
abline(a)
plot(housing$sell)
plot(resid(a),fitted(a),col=fitted(a))
plot(fitted(a),type="l")
abline(fitted(a))
plot(fitted(a))
abline(a)
abline(a,lty=3)
plot(fitted(a),type="s")
plot(housing$sell,type="l")
plot(resid(a))
abline(fitted(a))
plot(sell~.,data=housing)
abline(a)
plot
summary(a)
a1<-write.csv(a,head=TRUE)
a1<-write.csv(a,head=TRUE,col.names = NA, sep = " ")
a1<-write.csv(a1,"a1.csv",row.names=F)
a1<-summary(a)
write.csv(a1,"a1.csv",row.names=F)
qplot(resid(a))
qnorm(resid(a))
plot(qnorm(resid(a)))
plot(a)
par(mfrow=c(2,2))
plot(a)
hist(resid(a),freq=FALSE)
curve(dnorm,add=TRUE)
curve(dnorm,add=TRUE)
str_resid<-(resid(a)-mean(resid(a)))/sd(resid(a))
hist(str_resid)
curve(dnorm,add=TRUE)
hist(str_resid,freq=FALSE)
curve(dnorm,add=TRUE)
library(readxl)
housing<-read_excel("Final_project.xls")
attach(housing)
a<-lm(sell~.,data=housing)
std_resid<-(resid(a)-mean(resid(a)))/sd(resid(a))
hist(std_resid,freq = FALSE)
curve(dnorm,add=TRUE)
hist(std_resid,freq = FALSE,col = "blue")
curve(dnorm,add=TRUE)
curve(dnorm,add=TRUE,lty=2)
curve(dnorm,add=TRUE,lty=4)
curve(dnorm,add=TRUE,lty=10)
curve(dnorm,add=TRUE,lty=10,col="red")
library("dplyr")
trf_housing<-housing %>% mutate(log_sell=log(sell))
head(trf_housing)
str(trf_housing)
b<-lm(log_sell~lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=trf_housing)
summary(b)
plot(b)
std_resid_b<-(resid(b)-mean(resid(b)))/sd(resid(b))
plot(std_resid_b,freq=FALSE)
hist(std_resid_b,freq=FALSE,col="blue")
curve(dnorm,add=TRUE)
curve(dnorm,add=TRUE,col="red")
curve(dnorm,add=TRUE,col="red",wd=4)
curve(dnorm,add=TRUE,col="red",lty=4)
curve(dnorm,add=TRUE,col="red",lty=20)
?curve
curve(dnorm,add=TRUE,col="red",lwd=2)
summary(b)
trf_housing<-trf_housing %>% mutate(log_lot=log(lot),data=trf_housing)
trf_housing<-trf_housing %>% mutate(log_lot=log(lot),data=trf_housing)
library(dplyr)
trf_housing<-trf_housing %>% mutate(log_lot=log(lot),data=trf_housing)
str(trf_housing)
trf_housing<-trf_housing %>% mutate(log_lot=log(lot))
str(trf_housing)
c<-lm(log_sell~lot+log_lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=trf_housing)
summary(c)
trf_housing
names(trf_housing)
new_model<-lm(log_sell~log_lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=trf_housing)
trf_housing_new<- trf_housing %>% mutate(log_lot_c=log_lot-mean(log_lot),bdms_int=(bdms-mean(bdms))*log_lot_c,fb_int=(fb-mean(fb))*log_lot_c,sty_int=(sty-mean(sty))*log_lot_c,drv_int=(drv-mean(drv))*log_lot_c,rec_int=(rec-mean(rec))*log_lot_c,ffin_int=(ffin-mean(ffin))*log_lot_c,ghw_int=(ghw-mean(ghw))*log_lot_c,ca_int=(ca-mean(fb))*log_lot_c,gar_int=(gar-mean(gar))*log_lot_c,reg_int=(reg-mean(reg))*log_lot_c)
str(trf_housing_new)
interaction_model<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int+reg_int)
interaction_model<-lm(log_Sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int+reg_int)
interaction_model<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int+reg_int,data=trf_housing_new)
summary(trf_housing_new)
summary(interaction_model)
summary(trf_housing_new)
summary(new_model)
nrow(housing)
((.69)^2-(.68)^2)/(1-(.69)^2)
524/10*.02615003
qf(.95,10,524)
qf(.95,4,5)
summary(interaction_model)
interaction_model_1<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_in+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
interaction_model_1<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_in+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
interaction_model_1<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+bdms_int+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_1)
interaction_model_2<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_2)
interaction_model_2<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
interaction_model_2<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ffin_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
interaction_model_3<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ghw_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_3)
interaction_model_4<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+ca_int+gar_int,data=trf_housing_new)
summary(interaction_model_4)
interaction_model_5<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int+gar_int,data=trf_housing_new)
summary(interaction_model_5)
interaction_model_6<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+fb_int+sty_int+drv_int+rec_int,data=trf_housing_new)
summary(interaction_model_6)
interaction_model_7<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+sty_int+drv_int+rec_int,data=trf_housing_new)
summary(interaction_model_7)
interaction_model_8<-lm(log_sell~bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg+log_lot+drv_int+rec_int,data=trf_housing_new)
summary(interaction_model_8)
lmOut(interaction_model_1, file=“my-results.xls”)
lmOut(interaction_model_1, file=“my-results.csv”)
ibrary(lmOut)
library(lmOut)
install.packages("lmOut")
install.packages("xtable")
libray("xtable")
library("xtable")
xtable(interaction_model_1)
install.packages("stargazer")
library("stargazer")
stargazer(interaction_model_1)
stargazer(interaction_model_1, type = "text", out = "interaction_model_1.txt")
stargazer(interaction_model_1, type = "excel", out = "interaction_model_1.xls")
stargazer(interaction_model, type = "text", out = "interaction_model.txt")
stargazer(interaction_model_2, type = "text", out = "interaction_model_2.txt")
stargazer(interaction_model_3, type = "text", out = "interaction_model_3.txt")
stargazer(interaction_model_4, type = "text", out = "interaction_model_4.txt")
stargazer(interaction_model, interaction_model_1,title="Regression Results", align=TRUE, dep.var.labels=c("log_sell"), covariate.labels=c("bdms","fb","sty","drv","rec","ffin","ghw","ca","gar","log_lot","fb_int","sty_int","drv_int","rec_int","ca_int","gar_int","Constant"),no.space=TRUE, omit.stat=c("LL","ser","f", "rsq"),column.labels=c("1", "2","3","4","5","6","7","8","9"), dep.var.caption="", model.numbers=FALSE)
stargazer(interaction_model, interaction_model_1,title="Regression Results", align=TRUE, dep.var.labels=c("log_sell"), covariate.labels=c("bdms","fb","sty","drv","rec","ffin","ghw","ca","gar","log_lot","fb_int","sty_int","drv_int","rec_int","ca_int","gar_int","Constant"),no.space=TRUE, omit.stat=c("LL","ser","f", "rsq"),column.labels=c("1", "2","3","4","5","6","7","8","9"), dep.var.caption="", model.numbers=FALSE,type = "text", out = "interaction_model_final.txt")
stargazer(interaction_model, interaction_model_1,title="Regression Results", align=TRUE, dep.var.labels=c("log_sell"), covariate.labels=c("bdms","fb","sty","drv","rec","ffin","ghw","ca","gar","log_lot","fb_int","sty_int","drv_int","rec_int","ca_int","gar_int","Constant"),no.space=TRUE, omit.stat=c("LL","ser","f", "rsq"),column.labels=c("1", "2","3","4","5","6","7","8","9"), dep.var.caption="", model.numbers=FALSE,type = "text", out = "interaction_model_final.txt")
stargazer(interaction_model, interaction_model_1,title="Regression Results", align=TRUE, dep.var.labels=c("log_sell"), covariate.labels=c("bdms","fb","sty","drv","rec","ffin","ghw","ca","gar","log_lot","fb_int","sty_int","drv_int","rec_int","ca_int","gar_int","Constant"),no.space=TRUE, omit.stat=c("LL","ser","f", "rsq"),column.labels=c("1", "2","3","4","5","6","7","8","9"), dep.var.caption="", model.numbers=FALSE)
stargazer(interaction_model_5, type = "text", out = "interaction_model_5.txt")
stargazer(interaction_model_6, type = "text", out = "interaction_model_6.txt")
stargazer(interaction_model_7, type = "text", out = "interaction_model_7.txt")
stargazer(interaction_model_8, type = "text", out = "interaction_model_8.txt")
stargazer(interaction_model_9, type = "text", out = "interaction_model_9.txt")
trf_housing_new
trf_housing
names(trf_housing)
trf_housing$obs<-NULL
names(trf_housing)
train<-trf_housing[1:nrow(trf_housing),]
nrow(trf_housing)
train<-trf_housing[1:400,]
nrow(train)
test<-trf_housing[401:nrow(trf_housing),]
nrow(test)
names(train)
names(train)
attach(train)
train_lm<-lm(log_sell~log_lot+bdms+fb+sty+drv+rec+ffin+ghw+ca+gar+reg,data=train)
summary(train_lm)
prediction<-predict(train_lm,test)
prediction
prediction$metric
prediction<-predict(train_lm,test,metric=rmse)
summary(predicition)
summary(prediction)
?predict
prediction
MAE<-mean(abs(prediction-test$log_sell))
MAE
class(prediction)
sd(trf_housing$log_sell)
(sd(trf_housing$log_sell))^2
housing$obs<-NULL
a<-lm(sell~.,data=housing)
summary(a)
std_resid<-(resid(a)-mean(resid(a)))/sd(resid(a))
plot(std_resid,freq=FALSE)
hist(std_resid,freq=FALSE,col="blue")
curve(dnorm,add = TRUE,lwd=2,col="red")
